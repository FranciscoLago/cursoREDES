<div class="sidebar-shell">
    <div class="sidebar-card">
        <div class="sidebar-header">
            <div class="sidebar-avatar">
                @if (identity.image) {
                <img src="{{url + 'get-image-user/' + identity.image}}" alt="{{identity.name}}">
                }
                @if (!identity.image) {
                <div class="sidebar-avatar-fallback">
                    {{identity.name.charAt(0)}}{{identity.surname.charAt(0)}}
                </div>
                }
            </div>

            <div class="sidebar-info">
                <h3 class="sidebar-name">{{identity.name}} {{identity.surname}}</h3>
                <p class="sidebar-nick">@{{identity.nick}}</p>
            </div>
        </div>

        @if (stats) {
        <div class="sidebar-stats">
            <div class="sidebar-stat">
                <span class="sidebar-stat-label">Siguiendo</span>
                <span class="sidebar-stat-number">{{stats.following}}</span>
            </div>
            <div class="sidebar-stat">
                <span class="sidebar-stat-label">Seguidores</span>
                <span class="sidebar-stat-number">{{stats.followed}}</span>
            </div>
            <div class="sidebar-stat">
                <span class="sidebar-stat-label">Publicaciones</span>
                <span class="sidebar-stat-number">{{stats.publications}}</span>
            </div>
        </div>
        }
    </div>
</div>

<!-- Formulario de publicaciones -->

<div class="sidebar-shell">
    <div class="sidebar-card">
        <div id="new-publication">
            @if (status === "success") {

            <div class="alert alert-success">
                Publicación creada correctamente.
            </div>

            }

            @if (status === "error") {
            <div class="alert alert-danger">
                Error al crear la publicación. Por favor, inténtalo de nuevo.
            </div>
            }


            <form #newPubForm="ngForm" (ngSubmit)="onSubmit(newPubForm)">
                <p>
                    <label>Que estas pensando?</label>
                    <textarea name="text" id="text" [(ngModel)]="publication.text" class="form-control"
                        required></textarea>
                    @if (!newPubForm.form.controls['text']?.valid && newPubForm.form.controls['text']?.touched) {
                    <span class="error">El texto es obligatorio</span>
                    }

                </p>

                <p>
                    <label>Sube tu foto</label>
                    <input type="file" placeholder="Subir imagen">
                </p>
                <input type="submit" value="Enviar" class="btn btn-success" [disabled]="!newPubForm.form.valid">
            </form>
        </div>
    </div>
</div>