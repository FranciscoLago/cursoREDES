<div class="users-container">
    <div class="users-main">
        <h1 class="h1-strong">{{title}}{{user.name}}</h1>


        <div class="people">
            @if (status === 'error') {
            <div class="form-alert form-alert-error">
                No se pudieron cargar los usuarios. Intentalo de nuevo.
            </div>
            }

            @if (followed.length === 0) {
            <div class="form-alert">
                No hay usuarios para mostrar.
            </div>
            }

            <div class="people-grid">
                @for (follow of followed; track $index) {
                <div class="people-card">
                    <div class="people-avatar">
                        @if (follow.user.image) {
                        <img src="{{url + 'get-image-user/' + follow.user.image}}"
                            alt="Foto de perfil de {{follow.user.name}}">
                        }
                        @if (!follow.user.image) {
                        <div class="people-fallback">
                            {{follow.user.name.charAt(0)}}{{follow.user.surname.charAt(0)}}
                        </div>
                        }
                    </div>
                    <div class="people-meta">
                        <div class="people-name">
                            <a [routerLink]="['/perfil', follow.user._id]" class="user-link">{{follow.user.name}}
                                {{follow.user.surname}}</a>
                        </div>
                        <div class="people-nick">@{{follow.user.nick}}</div>
                        <div class="people-email">{{follow.user.email}}</div>
                    </div>
                    @if (follow.user._id !== identity._id) {
                    <div class="people-actions">

                        @if (follows?.includes(follow.user._id)) {
                        <button class="people-btn people-btn-following people-btn-hover-unfollow"
                            (click)="unfollowUser(follow.user._id!)">
                            <span class="btn-text-default">Siguiendo</span>
                            <span class="btn-text-hover">Dejar de seguir</span>
                        </button>
                        } @else {

                        <button class="people-btn people-btn-primary"
                            (click)="followUser(follow.user._id!)">Seguir</button>
                        }
                    </div>
                    }
                </div>
                }
            </div>


            <div class="home-actions">
                @if (page > 1) {
                <a class="home-btn" [routerLink]="['/followed',identity._id, prev_page]">Anterior</a>
                }

                @if (page < pages) { <a class="home-btn home-btn-primary"
                    [routerLink]="['/followed',identity._id, next_page]">Siguiente</a>
                    }
            </div>

            <p class="people-stats">Total: {{total}} usuarios Â· Pagina {{page}} de {{pages}}</p>
        </div>
    </div>

    <div class="users-sidebar">
        <h1 class="h1-strong">Mis datos</h1>
        <sidebar></sidebar>
    </div>